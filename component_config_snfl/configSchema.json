{
  "type": "object",
  "title": "Authorization",
  "required": [
    "db_settings"
  ],
  "properties": {
    "db_settings": {
      "propertyOrder": 1,
      "type": "object",
      "format": "grid-strict",
      "title": "Authorization",
      "description": "The connector",
      "required": [
        "#password",
        "host",
        "port",
        "user"
      ],
      "properties": {
        "host": {
          "type": "string",
          "title": "Hostname",
          "propertyOrder": 10,
          "options": {
            "grid_columns": 8
          }
        },
        "port": {
          "type": "integer",
          "title": "Port",
          "default": 3306,
          "propertyOrder": 20,
          "options": {
            "grid_columns": 4
          }
        },
        "user": {
          "type": "string",
          "title": "User",
          "propertyOrder": 30,
          "options": {
            "grid_columns": 12
          }
        },
        "#password": {
          "type": "string",
          "title": "Password",
          "format": "password",
          "propertyOrder": 40,
          "options": {
            "grid_columns": 12
          }
        },
        "sync_from_replica": {
          "propertyOrder": 50,
          "type": "boolean",
          "title": "Sync from replica server",
          "format": "checkbox",
          "default": false,
          "options": {
            "grid_columns": 12
          }
        },
        "replica_db_settings": {
          "propertyOrder": 60,
          "type": "object",
          "format": "grid-strict",
          "title": "Replica Authorization",
          "description": "The connector",
          "options": {
            "dependencies": {
              "sync_from_replica": true
            }
          },
          "required": [
            "#password",
            "host",
            "port",
            "user"
          ],
          "properties": {
            "host": {
              "type": "string",
              "title": "Hostname",
              "propertyOrder": 1,
              "options": {
                "grid_columns": 8
              }
            },
            "port": {
              "type": "integer",
              "title": "Port",
              "default": 3306,
              "propertyOrder": 2,
              "options": {
                "grid_columns": 4
              }
            },
            "user": {
              "type": "string",
              "title": "User",
              "propertyOrder": 3,
              "options": {
                "grid_columns": 12
              }
            },
            "#password": {
              "type": "string",
              "title": "Password",
              "format": "password",
              "propertyOrder": 4,
              "options": {
                "grid_columns": 12
              }
            }
          }
        },
        "use_ssh": {
          "propertyOrder": 70,
          "type": "boolean",
          "title": "SSH Tunnel",
          "format": "checkbox",
          "default": false,
          "options": {
            "grid_columns": 12
          }
        },
        "ssh_options": {
          "propertyOrder": 80,
          "options": {
            "grid_columns": 12,
            "dependencies": {
              "use_ssh": true
            }
          },
          "title": "SSH Tunnel",
          "type": "object",
          "description": "",
          "properties": {
            "host": {
              "propertyOrder": 1,
              "title": "SSH host",
              "type": "string",
              "description": "The host name or host IP associated with your SSH server (Note: Don't use load balancer as host)"
            },
            "port": {
              "propertyOrder": 2,
              "title": "SSH port",
              "default": 22,
              "type": "number",
              "description": "Custom SSH port"
            },
            "username": {
              "propertyOrder": 3,
              "title": "Username",
              "description": "The SSH User for connecting to your SSH server",
              "type": "string"
            },
            "#private_key": {
              "propertyOrder": 4,
              "title": "Private key",
              "type": "string",
              "format": "textarea",
              "options": {
                "input_height": "150px"
              },
              "description": "The private key of the key pair associated with your SSH server"
            },
            "generate_key": {
              "propertyOrder": 5,
              "type": "button",
              "format": "sync-action",
              "title": "Generate SSH Key Pair",
              "description": "Generate your own SSH Key Pair",
              "options": {
                "async": {
                  "label": "Generate SSH Key Pair",
                  "action": "generate_ssh_key"
                }
              }
            }
          }
        },
        "test_connection": {
          "type": "button",
          "format": "sync-action",
          "propertyOrder": 90,
          "options": {
            "async": {
              "label": "TEST CONNECTION",
              "action": "test_connection"
            }
          }
        }
      }
    },
    "advanced_options": {
      "propertyOrder": 2,
      "title": "Advanced Options",
      "type": "object",
      "description": "",
      "properties": {
        "max_execution_time": {
          "type": "string",
          "title": "Max connection time",
          "description": "Optional parameter which sets @@session.max_execution_time to desired integer value. Use this when initial full syncs are failing due to the size of the tables.",
          "propertyOrder": 1
        },
        "show_binary_log_config": {
          "type": "object",
          "title": "Show Binary Log Method",
          "required": [
            "method"
          ],
          "propertyOrder": 1300,
          "properties": {
            "method": {
              "type": "string",
              "title": "Method",
              "default": "direct",
              "enum": [
                "direct",
                "endpoint"
              ],
              "propertyOrder": 1
            },
            "endpoint_url": {
              "type": "string",
              "title": "Endpoint Url",
              "options": {
                "dependencies": {
                  "method": "endpoint"
                }
              },
              "propertyOrder": 10
            },
            "authentication": {
              "type": "boolean",
              "title": "Enable Basic Authentication",
              "format": "checkbox",
              "default": false,
              "options": {
                "dependencies": {
                  "method": "endpoint"
                }
              },
              "propertyOrder": 11
            },
            "user": {
              "type": "string",
              "title": "Username",
              "options": {
                "dependencies": {
                  "authentication": true
                }
              },
              "propertyOrder": 13
            },
            "#password": {
              "type": "string",
              "title": "Password",
              "options": {
                "dependencies": {
                  "authentication": true
                }
              },
              "propertyOrder": 15
            }
          }
        }
      }
    },
    "source_settings": {
      "title": "Data Source",
      "type": "object",
      "propertyOrder": 3,
      "properties": {
        "schemas": {
          "type": "array",
          "title": "Databases",
          "description": "MySQL Database(s) to Extract. If left empty, all non-system databases are pulled",
          "items": {
            "enum": [],
            "type": "string"
          },
          "format": "select",
          "uniqueItems": true,
          "options": {
            "async": {
              "label": "Re-load schemas",
              "action": "get_schemas"
            }
          },
          "propertyOrder": 100
        },
        "tables": {
          "type": "array",
          "title": "Tables to sync",
          "description": "If left empty all tables are synced.",
          "items": {
            "enum": [],
            "type": "string"
          },
          "format": "select",
          "uniqueItems": true,
          "options": {
            "async": {
              "label": "Re-load tables",
              "action": "get_tables"
            }
          },
          "propertyOrder": 102
        }
      }
    },
    "sync_options": {
      "title": "Sync Options",
      "type": "object",
      "propertyOrder": 4,
      "properties": {
        "snapshot_mode": {
          "propertyOrder": 1,
          "type": "string",
          "title": "Replication Mode",
          "description": " Standard mode performs full sync of the tables on the first run. The mode 'Snapshot Only' will perform full sync each time.",
          "enum": [
            "initial",
            "snapshot_only"
          ],
          "options": {
            "enum_titles": [
              "Standard",
              "Snapshot only"
            ]
          }
        },
        "handle_binary": {
          "propertyOrder": 2,
          "type": "string",
          "title": "Binary data handler",
          "default": "plain",
          "enum": [
            "plain",
            "hex",
            "base64"
          ],
          "description": "Marks how to handle binary data:<ul><li><strong>plain</strong> - data in decoded from binary to string using Python's <i><a href='https://docs.python.org/3/library/stdtypes.html#bytes.decode' target='_blank'>bytes.decode()</a></i> method,</li><li><strong>hex</strong> - data is converted to hex representation of binary string using <i><a href='https://docs.python.org/3/library/stdtypes.html#bytes.hex' target='_blank'>bytes.hex()</a></i> method,</li><li><strong>base64</strong> - data is converted to a base64 string, using <i><a href='https://docs.python.org/3/library/base64.html#base64.b64encode' target='_blank'>base64.b64encode()</a></i> method.</li></ul>All trailing or leading null bytes are replaced."
        }
      }
    },
    "destination": {
      "title": "Destination",
      "type": "object",
      "propertyOrder": 5,
      "required": [
        "load_type"
      ],
      "properties": {
        "load_type": {
          "enum": [
            "incremental_load",
            "append_only"
          ],
          "type": "string",
          "title": "Load Type",
          "default": "incremental_load",
          "options": {
            "enum_titles": [
              "Incremental Load",
              "Append"
            ]
          },
          "description": "If Full load is used, the destination table will be overwritten every run. If Incremental Load is used, data will be upserted into the destination table.",
          "propertyOrder": 1
        },
        "outputBucket": {
          "type": "string",
          "title": "Output Bucket",
          "default": "",
          "description": "(Optional) The name of bucket in Keboola storage where the data. Keboola will create a bucket for you if not specified",
          "propertyOrder": 2
        }
      }
    }
  }
}